import math
import random

import numpy as np
a = [[0, 1, 70, 8, 74, 77, 81, 17, 20, 86, 28, 30, 32, 97, 98, 100, 101, 102, 39, 105, 41, 106, 109, 110, 47, 51, 57, 123, 126], [64, 65, 69, 5, 71, 9, 10, 76, 12, 25, 95, 104, 43, 45, 46, 112, 48, 50, 115, 116, 118, 59, 61, 62, 127], [128, 129, 4, 68, 73, 13, 78, 15, 22, 23, 26, 92, 34, 35, 99, 108, 113, 54, 120, 121, 122, 63], [72, 11, 16, 80, 19, 55, 91, 94, 33, 40, 111, 114, 117, 53, 119, 125], [66, 67, 131, 36, 6, 103, 7, 75, 107, 44, 14, 82, 83, 89, 93],   [96, 3, 37, 38, 42, 79, 49, 52, 21, 24, 58, 60, 29, 31],  [2, 130, 27, 18, 84, 85, 87, 56, 90, 88, 124]]
# a 是社团分配
# 打社团标签
node = 132
communitycount = 7
edge = 459
g = 0
limit = 0.2  # 阈值，异常分数高于阈值为异常
balance = 0.4  # 结构和属性的平衡参数, 结构的占比
coresite = 8
dimension = 28  # 属性维度,不包含id
def commmunitylabel():
    f = [0] * node  # 节点数,没有零节点加一
    for i in range(communitycount):
        for j in range(len(a[i])):
            f[a[i][j]] = i+1
    return f
# f=0是异常，f=1是一号社团
# f[0]是0号节点所属社区

def b():
    b = [[0.0] * 3 for i in range(edge)]
    b = np.loadtxt(r'C:\Users\lustriyrate\Desktop\邻接矩阵A.txt')
    return b

# 计算kin k_out
def kinkout(f, b):
    kin = [0.0] * node
    k_out = [0.0] * node
    for i in range(edge):
        if f[int(b[i][0])] == f[int(b[i][1])] and f[int(b[i][0])] != 0 and f[int(b[i][1])] != 0:
            kin[int(b[i][0])] = kin[int(b[i][0])] + b[i][2]
        if f[int(b[i][1])] == f[int(b[i][0])] and f[int(b[i][1])] != 0 and f[int(b[i][0])] != 0:
            kin[int(b[i][1])] = kin[int(b[i][1])] + b[i][2]
        if f[int(b[i][0])] != f[int(b[i][1])] and f[int(b[i][0])] != 0 and f[int(b[i][1])] != 0:
            k_out[int(b[i][0])] = k_out[int(b[i][0])] + b[i][2]
        if f[int(b[i][1])] != f[int(b[i][0])] and f[int(b[i][0])] != 0 and f[int(b[i][1])] != 0:
            k_out[int(b[i][1])] = k_out[int(b[i][1])] + b[i][2]
    # 没有零节点时全减一
    return kin, k_out

def structure(kin, k_out):
    structure1 = [0.0] * node
    for i in range(node):
        if kin[i] == 0.0:
            structure1[i] = 0.0
        else:
            structure1[i] = kin[i] / (kin[i] + k_out[i])
    # 计算了契合度的结构占比
    return structure1

# 计算Q
# 计算k
def k1(kin, k_out):
    k1 = [0.0] * node
    for i in range(node):
        k1[i] = kin[i] + k_out[i]
    return k1

def Q(f, b, k1):
    m = 0.0
    for i in range(edge):
        m = m + b[i][2]
    Qsum = 0.0
    for i in range(node):
        for j in range(node):
            for k in range(edge):
                edge_value = 0.0
                if b[k][0] == float(i) and b[k][1] == float(j):
                    edge_value = b[k][2]
                else:
                    edge_value = 0.0
                if edge_value != 0:
                    break
            if f[i] == f[j] and i != j:
                Qsum = Qsum + (edge_value - ((k1[i] * k1[j]) / (2 * m)))
    Q = Qsum / (2*m)
    return Q

# 计算契合度的属性占比，对比与同社团平均值的差距
def attribute():
    attribute = [[-0.277444832, 0.910260943, 0.736542309, -0.219907139, -0.018541137, 0.379965026, -0.787254667, -0.607188445, -0.221987044, 0.780209634, 2.11271529, 1.285211318, -0.528660447, 2.199806411, 0.766632476, 0.368581005, -1.03214367, -0.266987358, 0.918453662, -0.042262443, -0.542212974, 2.537099633, 0.090166963, 0.749743931, 1.559263717, -1.686988862, 0.980201572, -0.546019199], [0.224577607, 0.552589753, -1.666911542, 0.262691051, 0.528227102, 0.186410398, -0.787254667, -0.63878957, -0.221987044, -0.674617352, 0.430902348, 1.783946934, 0.951289867, 0.643036211, -1.300756125, 0.206600619, 1.360114555, -0.266987358, 0.030946968, -0.838442286, 0.472099227, 0.780749106, 0.090166963, -1.356404223, 0.531941547, 0.255920911, -1.203241451, 1.230711517], [-0.960541458, -0.569197164, -1.666911542, 0.116342417, 2.743032705, -0.811140381, -0.787254667, 2.177530698, -0.221987044, -1.402030846, -1.077662363, -0.670214981, 0.638146831, -0.700477798, -1.276201398, -0.799382829, -1.03214367, -0.266987358, -1.435821644, 2.396237639, 0.761902714, -0.524646556, 0.090166963, -1.519469249, -0.32174782, -1.686988862, -1.203241451, 2.886335622], [-0.206619118, -0.616886656, -0.865760258, -0.526909161, -1.501307608, -0.677141023, -0.335205397, 0.385023505, -0.221987044, -0.674617352, -1.359003499, -0.834935001, 2.967350097, -0.785780274, -1.016488753, -0.697079427, -1.03214367, -0.266987358, -0.377067854, 1.51608155, 2.645625374, -0.667053355, 0.090166963, -1.731534548, -1.290693585, -1.686988862, -0.47542711, -0.31862068], [-0.018140701, -0.944209988, -0.064608974, 0.344164344, -0.029998464, 0.178965989, -0.280313699, -0.7454979, -0.221987044, 0.052796141, 0.038197905, -0.960554814, -0.672031575, 0.088570112, 0.312982283, 0.155448919, 0.163985443, -0.266987358, -1.105240292, 1.917505397, 0.472099227, 0.234856375, 0.090166963, 0.534654578, -0.018212449, -0.39171568, -1.203241451, -0.253473738], [2.342334943, -0.75887128, -0.064608974, 1.349242044, 0.056515251, -0.69202984, 0.780618263, 0.511885384, -0.221987044, 0.052796141, 0.991843176, -0.465978794, 0.159827332, -0.508547225, -1.926361946, -0.671503577, -1.03214367, -0.266987358, -0.368133223, 0.742321142, -0.107507745, -0.453443156, 0.090166963, -1.164244882, 0.750590392, 0.255920911, -1.203241451, 0.146676098], [-0.189868564, -0.245125388, 0.736542309, -0.089139313, 0.94877794, -0.513364029, -0.787254667, -0.038532093, -0.221987044, 0.780209634, 0.787807695, 0.161704313, -0.47792642, 0.259175065, 0.146022935, -0.475422057, 1.360114555, -0.266987358, 0.301964113, -0.797565472, -0.976918203, 0.163652975, 0.090166963, 0.170124219, 1.052475335, 0.903557502, -1.203241451, 0.489131291], [-0.063641171, -0.083631426, -0.865760258, 0.180117392, 0.774863189, -0.63247457, 1.334147982, -0.237761027, -0.221987044, -0.674617352, -0.79723895, -0.045443591, 0.407236279, -0.700477798, -1.246774125, -0.603301309, -0.434079113, -0.266987358, -1.16778271, -0.002255348, -1.266721689, -0.548381022, 0.090166963, -1.282025145, -0.454520699, 0.255920911, -1.203241451, 2.080381551], [-0.435083849, 0.081114092, 0.736542309, -0.107817789, -0.754417539, 0.379965026, -0.787254667, -0.610756936, -0.221987044, 0.780209634, 0.459230675, -0.055842583, -0.731579812, 0.685687449, 0.870065266, 0.360055722, -0.434079113, -0.266987358, 0.873780506, -1.028234399, -1.411623433, 0.211121908, 0.090166963, 0.89754667, -0.031817255, 0.903557502, 0.980201572, -0.491542799], [0.123215945, 0.175409224, -0.064608974, 1.541889257, 0.054553807, -0.491030803, 0.042578637, -0.061784174, -0.221987044, 0.052796141, -0.338032545, -0.543763248, -0.512806587, -0.401919129, -0.618420564, -0.449846207, 0.163985443, -0.266987358, 0.410668792, -0.47219376, -0.687114717, -0.358505289, 0.090166963, -0.037090832, -0.275562068, -0.39171568, 0.616294402, 0.226943389], [-0.763497022, 0.064856311, 0.736542309, 0.053297937, -0.06486859, -0.193254451, 0.872411941, -0.426474924, -0.221987044, 0.780209634, -0.420839297, 0.068113392, -0.275007055, -0.401919129, 0.731078255, -0.108834869, -1.03214367, -0.266987358, 0.483634946, -0.850714994, 0.761902714, -0.311036356, 0.090166963, 0.674755164, -0.376109874, -1.686988862, 0.980201572, -0.505161899], [-0.43824842, -0.006677927, 0.736542309, -0.574382079, -1.229250577, 2.241067225, -0.787254667, -0.778142788, -0.221987044, 0.780209634, -1.188284146, 0.160456434, -0.713248263, 0.152546969, 1.016493363, 1.229634635, -0.434079113, -0.266987358, 0.864845875, 1.880397367, 1.0517062, -0.073691691, 0.090166963, 0.89681361, -1.156777833, 0.903557502, 0.980201572, -0.362885003], [-0.038194548, -0.529094636, 0.736542309, -0.159091131, -0.352103466, -0.498475212, 0.579963739, 0.144965149, -0.221987044, 0.780209634, -0.567883214, -0.420223233, -0.501673728, -0.593849702, 0.593874714, -0.475422057, -1.03214367, -0.266987358, 1.085233443, -0.375654901, 0.182295741, -0.524646556, 0.090166963, 0.629318338, -0.567519353, 0.903557502, 0.980201572, -0.518196681], [-0.341247798, -0.780548322, -2.468062826, -0.41204578, 0.495551926, -0.535697256, 0.190186562, -0.489539219, -0.221987044, -1.402030846, -0.819494735, -0.358661205, 3.348621204, -0.359267891, -1.82477236, -0.518048475, -1.03214367, -0.266987358, -1.328606071, -0.254377354, -1.846328662, -0.382239756, 0.090166963, -2.598805102, -0.541215754, -1.686988862, -1.203241451, 1.002818576], [-0.960541458, -0.705762527, -0.064608974, 0.578680933, -1.404278371, -0.81858479, -0.787254667, 2.806563677, -0.221987044, 0.052796141, 2.267066894, 0.036084499, -1.035967231, -0.252639795, 1.070471097, -0.807908112, 1.360114555, -0.266987358, -1.47751659, 0.407382516, -1.556525176, -0.548381022, 0.090166963, 1.277923182, 0.611686599, 0.903557502, -1.203241451, -0.709466379], [-0.473232109, -0.280892507, 0.736542309, -0.390389844, -0.834906818, 2.330400131, 1.332302883, -0.834506459, -0.221987044, 0.780209634, 0.331065022, 0.162536232, -0.330252819, 2.093178315, 0.778199438, 2.551053571, 1.360114555, -0.266987358, -0.861027041, -0.883571063, 0.472099227, 2.370958367, 0.090166963, 0.642114615, -0.147958666, 0.903557502, 0.980201572, -0.414727478], [-0.43824842, 0.021502227, 0.736542309, -0.574382079, -1.24007744, 2.241067225, 1.011255646, -0.778142788, -0.221987044, 0.780209634, -1.192498505, -0.025061569, -0.713248263, 0.152546969, 1.016493363, 1.229634635, -0.434079113, -0.266987358, 0.864845875, -0.710496891, 1.196607943, -0.121160624, 0.090166963, 0.89681361, -1.160995206, 0.903557502, 0.980201572, -0.362885003], [0.158173624, -0.441302617, -0.064608974, 0.852107931, 0.433338329, -0.156032407, -0.787254667, -0.634688746, -0.221987044, 0.052796141, -0.893372153, -0.019654093, -0.135904917, -0.657826559, -0.477918882, -0.142936003, -1.03214367, -0.266987358, -0.810397464, -0.610092612, -1.266721689, -0.453443156, 0.090166963, -0.168206767, -0.617837302, 0.903557502, 0.616294402, 0.160483978], [0.484471303, 4.198668193, 0.736542309, 0.578680933, 0.045221378, -0.759029519, -0.787254667, 2.458191279, -0.221987044, -0.674617352, 0.882538298, 3.074253758, -0.338422495, -0.401919129, 0.003801781, -0.739705845, -1.03214367, 0.408654119, 0.447896422, -0.614537844, 1.0517062, -0.334770823, 0.090166963, 0.321549223, 0.660302781, 0.255920911, -1.203241451, -0.709466379], [-0.754107348, 0.018250671, 0.736542309, -1.166887381, -1.187297458, 1.340293761, -0.787254667, -0.720185319, -0.221987044, 0.780209634, -0.42540212, 1.384209714, -0.808195642, 0.429780019, 1.585663844, 1.36603917, -1.03214367, -0.266987358, 1.147775861, 2.893620532, 0.327197484, 0.187387442, 0.090166963, 1.251086864, -0.723775691, 0.903557502, 0.980201572, -0.556581867], [0.211086995, -0.743697351, -0.865760258, 1.016025428, -0.790719831, -0.5729193, -0.787254667, -0.430899352, -0.221987044, -0.674617352, 0.078015048, -0.171063405, -0.35727302, -0.188662937, -0.976381986, -0.552149609, -1.03214367, -0.266987358, -1.315204124, -0.311585567, -1.556525176, -0.311036356, 0.090166963, -0.5734356, -0.287059647, -0.39171568, -0.111519939, 1.234208434], [-0.147723406, -0.595209614, -0.865760258, -0.86612693, -1.578846937, -0.610141344, -0.188058746, 0.541529756, -0.221987044, -0.674617352, -1.025742546, -0.83618288, 1.056675347, -0.721803417, -0.796200205, -0.637402443, -1.03214367, -0.266987358, 0.872291401, 0.536970715, 1.921116658, -0.643318888, -11.09053651, -1.277387212, -1.138502937, 0.255920911, -0.47542711, 1.537909871], [0.385259815, -0.517172263, -0.865760258, 0.640782242, -1.00897724, 1.645514522, -0.257249961, -0.804601485, -0.221987044, 0.780209634, 0.164824108, -0.691012963, 0.088434738, 0.4084544, -0.766747332, 1.817879193, 0.762049999, -0.266987358, -0.475348796, -0.843660603, 0.617000971, 0.021246176, 0.090166963, -0.525983217, -0.32174782, 0.903557502, 0.616294402, 0.498075849], [0.402998756, -0.369768379, -0.865760258, 0.654134578, -1.011366777, 1.660403339, 0.170351747, -0.80270948, -0.221987044, -0.674617352, 0.149406436, -0.263406446, 0.081763393, 0.4084544, -0.774836952, 1.83492976, 0.762049999, -0.266987358, -0.414295484, 0.166856769, 0.761902714, 0.021246176, 0.090166963, -0.525918662, -0.331788658, 0.903557502, 0.616294402, 0.490911213], [0.239932282, -0.814147737, 0.736542309, -0.168171459, -0.345160575, -0.364475853, -0.326441176, -0.249828529, -0.221987044, 0.780209634, -0.55299895, -0.971785724, 0.638146831, -0.316616652, -0.488508775, -0.356068089, 0.762049999, -0.266987358, 0.549155575, -0.172913632, -0.107507745, -0.334770823, 0.090166963, -0.614593133, -0.555106425, 0.255920911, 0.980201572, 0.258631394], [1.079471457, -0.495495221, 0.736542309, 0.442697928, -0.099365107, -0.721807475, -0.20005189, 0.471862499, -0.221987044, 0.780209634, 0.228852282, -0.858228741, -0.051194746, -0.572524083, -1.62757507, -0.697079427, -0.434079113, -0.266987358, -0.844646884, 0.589057246, -1.121819946, -0.524646556, 0.090166963, -1.316943775, 0.096924937, 0.255920911, -1.203241451, 1.934508853], [0.052312201, -0.656989183, 0.736542309, 0.51387032, 0.311783251, 0.744741057, 1.055538023, -0.718201932, -0.221987044, 0.780209634, -0.193825308, -0.419807273, 0.60685764, 0.13122135, -0.594330904, 0.863047446, -1.03214367, -0.266987358, 0.16049912, 0.90022354, 0.037393998, 0.234856375, 0.090166963, -0.535388194, -0.075303631, -1.686988862, 0.616294402, 0.046658866], [0.484471303, -0.109643876, -0.865760258, 0.578680933, -0.450199044, -0.759029519, -0.787254667, 2.458191279, -0.221987044, -0.674617352, 2.048457139, -0.62321154, 1.056675347, -0.401919129, -0.707312518, -0.739705845, -1.03214367, 1.084295596, 0.447896422, 1.339721772, 0.761902714, -0.334770823, 0.090166963, -0.634823301, 1.195083112, 0.255920911, -1.203241451, -0.709466379], [-0.418662756, -0.374103787, 0.736542309, 0.723161719, -0.340568304, -0.371920262, -0.787254667, -0.175761653, -0.221987044, -1.402030846, 0.832440375, -0.274637357, 1.187465508, -0.401919129, -0.862867038, -0.364593373, 0.762049999, -0.266987358, 0.860378559, -0.35806724, -0.252409488, -0.311036356, 0.090166963, -0.918747156, 0.420259619, 0.255920911, 0.980201572, 0.273760731], [-0.41180474, -0.466231215, -0.064608974, 0.373846477, -0.736927992, -0.26025413, -0.20005189, -0.309782398, -0.221987044, 0.052796141, -0.94705003, -0.834103081, -0.294267737, -0.487221606, 0.516882523, -0.296391105, -1.03214367, -0.266987358, 0.867824085, -0.798338556, 1.0517062, -0.28730189, 0.090166963, 0.619659444, -0.916959862, 0.255920911, 0.980201572, -0.709466379], [-0.023238695, -0.137824031, 0.736542309, -0.233536879, 0.640636556, -0.297476174, -0.787254667, -0.460074039, -0.221987044, 0.780209634, -0.920499875, -0.047939349, 0.660772483, -0.615175321, -0.515120041, -0.304916388, 0.762049999, -0.266987358, -0.195397021, 0.103367248, -0.252409488, -0.500912089, 0.090166963, -0.70913639, -0.594525361, 0.255920911, -0.47542711, 0.62681455], [-0.960541458, -0.83148937, -0.064608974, 1.112145606, -1.105959776, -0.654807796, -0.095803793, 0.760489168, -0.221987044, 0.052796141, -0.448738711, -0.586607092, 0.573760405, -0.721803417, -0.81671439, -0.714129994, 1.360114555, -0.266987358, 0.653392938, 2.693971599, 1.196607943, -0.572115489, 0.090166963, -0.735978446, -0.712174851, 0.903557502, 0.980201572, 1.019287349], [-0.075839945, -0.563777903, 0.736542309, -0.223337691, -0.716309474, -0.483586394, -0.787254667, -0.224446411, -0.221987044, 0.780209634, -1.170460018, 0.100142285, 0.50148053, -0.572524083, -0.300962709, -0.492472624, -1.03214367, -0.266987358, -0.131365497, 1.100742193, 0.327197484, -0.548381022, 0.090166963, -0.471362337, -1.055160662, -1.686988862, 0.616294402, 0.391289519], [-0.252778513, -0.317743478, 0.736542309, 0.342795822, -1.559878522, -0.483586394, 0.326262618, 0.040713148, -0.221987044, 0.052796141, 0.60518679, -0.237616948, -0.181825866, -0.082034842, -0.039735393, -0.500997908, -1.03214367, -0.266987358, 0.854422139, -0.658217088, 1.776214915, -0.073691691, 0.090166963, 0.055619057, -0.32889151, 0.903557502, -0.47542711, 0.207831701], [-0.018140701, -0.582203389, -1.666911542, 0.344164344, -0.072644316, 0.178965989, -0.280313699, -0.748200112, -0.221987044, -1.402030846, -0.018830822, -0.756734587, -0.672031575, 0.088570112, 0.312982283, 0.146923635, 0.163985443, -0.266987358, -1.133533291, -0.85680303, -0.397311231, 0.234856375, 0.090166963, 0.534654578, -0.077397442, -0.39171568, -1.203241451, -0.253473738], [1.467075125, -0.73285883, -0.865760258, -0.376815585, 0.041158386, -0.290031765, -0.787254667, -0.765414654, -0.221987044, -0.674617352, -1.293357176, 0.328920091, 1.307792456, -0.63650094, -1.617535579, -0.270815254, 1.360114555, -0.266987358, -1.900422464, -0.346084439, -1.411623433, -0.572115489, 0.090166963, -1.729871893, -1.014045209, -1.039352271, -1.203241451, 0.848711492], [1.079471457, -1.001654149, 0.736542309, -0.373190851, -0.900047015, -0.595252526, -0.453753011, -0.331096921, -0.221987044, 0.780209634, 0.215993219, -0.964298451, 0.687382526, -0.465895987, -0.749143022, -0.577725459, -1.03214367, -0.266987358, -1.161826289, 0.414920084, -0.83201646, -0.500912089, 0.090166963, -0.810627222, -0.246249311, 0.255920911, -1.203241451, 0.083722595], [0.278037193, -0.235370719, -0.865760258, 0.908920088, -0.358594913, -0.69202984, -0.20005189, 0.903483064, -0.221987044, 0.780209634, -0.94441447, -0.839094597, 0.159827332, -0.721803417, -0.300962709, -0.671503577, 1.360114555, -0.266987358, 0.255801852, -0.376138078, -0.107507745, -0.595849955, 0.090166963, -0.002933953, -0.83291401, -1.686988862, 0.980201572, -0.709466379], [-0.195538782, -0.233203015, 0.736542309, -0.373190851, -0.267979288, -0.595252526, -0.234186223, 0.241538413, -0.221987044, -2.129444339, -1.327134569, -0.837846718, 0.195000468, -0.679152179, -0.247181242, -0.637402443, -1.03214367, -0.266987358, 0.31536606, -0.166245783, -0.252409488, -0.548381022, 0.090166963, -0.430890524, -1.087026946, -1.039352271, 0.980201572, 0.876920558], [0.083073571, 1.430509948, 0.736542309, 0.664296779, -0.626511117, -0.044366275, -0.787254667, -0.477441335, -0.221987044, 0.780209634, 0.667977195, 0.992791686, -0.803449529, 0.66436183, 0.082816378, -0.006531467, 1.360114555, -0.266987358, 0.766564932, -0.79524622, 0.182295741, 0.828218039, 0.090166963, 0.441096865, 0.163335295, 0.903557502, 0.980201572, -0.043577785], [-0.583584623, 3.932040579, 0.736542309, -0.92894024, 2.067470723, -0.677141023, -0.787254667, -0.321534599, -0.221987044, 0.780209634, 2.08172386, 2.908285859, -1.035967231, 0.536408115, 1.580616365, -0.645927727, 0.762049999, -0.266987358, -1.610046952, 0.446906433, -2.136132148, 0.75701464, 0.090166963, 1.387074565, 3.0720978, 0.255920911, -1.203241451, -0.709466379], [0.426668018, 1.351388745, 0.736542309, 0.116342417, -1.175941316, -0.476141985, -0.787254667, -0.030463376, -0.221987044, 0.052796141, -0.96398529, 2.491494293, -0.868555825, -0.615175321, 0.345135963, -0.526573758, -1.03214367, -0.266987358, 0.654882043, 0.315288889, -0.107507745, -0.548381022, 0.090166963, 0.603679878, -1.021823635, 0.903557502, 0.980201572, -0.349886179], [-0.088688972, -0.921449094, -0.865760258, 1.056517036, -0.338194333, 0.48418675, -0.428382899, -0.724335445, -0.221987044, -0.674617352, -0.778203725, -0.927278042, 0.366923612, -0.38059351, -0.484839432, 0.539086674, -1.03214367, -0.266987358, -0.374089643, -0.847429387, 0.761902714, -0.311036356, 0.090166963, -0.238784261, -0.7115477, -1.686988862, -1.203241451, -0.307698432], [0.308243679, -0.575700276, 0.736542309, 0.071236671, 0.417319865, -0.543141664, -0.35873041, 0.187009085, -0.221987044, 0.780209634, -0.369580119, -0.849493588, -0.015167811, -0.423244748, -0.152294606, -0.518048475, 0.163985443, -0.266987358, 0.74571746, -0.345021449, 1.0517062, -0.192364023, 0.090166963, -0.077911243, -0.18514786, -0.39171568, 0.980201572, -0.051695308], [-0.293614492, -0.840160187, 0.736542309, -0.310433021, -0.380785701, -0.654807796, -0.787254667, 0.327948781, -0.221987044, 0.780209634, 1.653278033, -0.378211309, -0.392077851, 0.173872589, 0.496112338, -0.637402443, -1.03214367, -0.266987358, -0.199864336, 2.179194317, -1.701426919, 0.021246176, 0.090166963, 0.422704368, 0.970700062, 0.903557502, -1.203241451, -0.017966686], [1.148389758, -0.142159439, -0.064608974, -0.233536879, 2.452902363, -0.5729193, -0.14193127, 0.056052858, -0.221987044, 0.780209634, 1.61419192, -0.755070748, 0.773884, -0.103360461, -1.552959418, -0.535099042, -0.434079113, -0.266987358, 0.051794441, -0.046321134, 0.182295741, 0.116184042, 0.090166963, -1.581503937, 2.803365531, -1.039352271, -1.203241451, 1.477167786], [-0.26693672, -0.136740179, 0.736542309, -0.253528396, 1.073718845, -0.662252205, -0.049676316, 0.694543745, -0.221987044, 0.780209634, 3.067178599, -0.670214981, 1.977438081, -0.146011699, -0.934867217, -0.637402443, 0.762049999, 0.408654119, 0.403223266, -0.626907188, 0.472099227, -0.073691691, 0.090166963, -1.404704431, 3.271974695, -1.686988862, 0.980201572, 0.369274221], [-0.418662756, -0.149746404, 0.736542309, 0.723161719, -0.340568304, -0.371920262, -0.787254667, -0.175761653, -0.221987044, -1.402030846, 0.832440375, 0.495303949, 1.187465508, -0.401919129, -0.862867038, -0.364593373, 0.762049999, -0.266987358, 0.860378559, 2.76625495, 0.037393998, -0.311036356, 0.090166963, -0.918747156, 0.420259619, 0.255920911, 0.980201572, 0.273760731], [-0.485465563, -0.03377423, 0.736542309, -0.973001101, -0.063522043, -0.304920583, -0.049676316, -0.261976756, -0.221987044, 0.780209634, -1.543630368, -0.688101245, -0.806638716, -0.63650094, 1.377321993, -0.364593373, -1.03214367, -0.266987358, 0.869313191, -0.582261589, 0.182295741, -0.524646556, 0.090166963, 1.145275136, -1.218420092, 0.903557502, -0.47542711, -0.58631915], [-0.19230485, -1.001654149, 0.736542309, 1.076129436, -0.634598184, -0.26025413, -0.422847602, -0.60567223, -0.221987044, 0.780209634, -0.686931966, -0.922286526, -0.082358379, -0.38059351, -0.34725189, -0.296391105, 1.360114555, -0.266987358, -0.905700196, -0.768961365, 0.327197484, -0.405974223, 0.090166963, -0.03406391, -0.724955902, 0.903557502, -1.203241451, -0.026722464], [1.447810253, -0.322078886, -0.064608974, -0.191880178, 0.956491398, -0.714363067, -0.049676316, 0.683073088, -0.221987044, 0.052796141, 0.797523587, -0.701411954, -0.570931827, -0.38059351, -0.470272996, -0.697079427, -1.03214367, -0.266987358, -0.453012219, -0.545250194, 0.182295741, -0.405974223, 0.090166963, -0.196486253, 1.065439572, 0.903557502, -1.203241451, 0.289366511], [0.408417543, -0.542100861, -2.468062826, -0.759668863, 0.773205301, -0.706918658, 0.310118001, 1.232560892, -0.221987044, -2.129444339, 0.086722275, -0.461403238, 2.929037997, -0.615175321, -1.006726595, -0.680028861, 0.163985443, 0.408654119, 0.458320158, 0.008471192, -1.266721689, -0.453443156, 0.090166963, -1.685575542, 0.335341006, -0.39171568, 0.980201572, -0.709466379], [0.373312473, -0.830405518, -1.666911542, -0.168171459, -0.426443771, -0.364475853, -0.787254667, -0.259490868, -0.221987044, -1.402030846, -0.519366714, -0.671462859, 0.638146831, -0.316616652, -0.619790167, -0.364593373, 0.762049999, -0.266987358, 0.501504209, 0.640563965, 0.761902714, -0.334770823, 0.090166963, -0.724943809, -0.555106425, 0.255920911, -0.111519939, 0.396934928], [-0.850561757, 0.780198692, -0.064608974, -0.951040022, -0.390647408, 2.672842936, 3.086992093, -0.807025843, -0.221987044, 0.780209634, -0.882438605, 0.994455525, -0.947481932, 0.941594879, 1.650035204, 2.875014343, 0.762049999, -0.266987358, 0.312387849, 0.459758954, -1.121819946, 0.567138907, 0.090166963, 1.390899103, -0.796851938, 0.255920911, 0.980201572, -0.652454938], [0.063011054, 2.318184812, 0.736542309, 0.193395754, -0.447451465, 0.223632442, 2.393234845, -0.578345762, -0.221987044, 0.780209634, 0.205455354, 0.742383979, 0.300997, -0.209988557, -0.381385309, 0.249227037, -1.03214367, -0.266987358, 0.7859233, -0.652129052, 0.472099227, -0.049957224, 0.090166963, -0.36584326, -0.064891171, 0.255920911, 0.980201572, 0.226943389], [-0.850561757, 0.915680204, -0.064608974, -0.951040022, -0.390865346, 2.672842936, -0.787254667, -0.807025843, -0.221987044, 0.780209634, -0.880590041, 1.260669699, -0.947481932, 0.941594879, 1.650035204, 2.883539626, 0.762049999, -0.266987358, 0.312387849, -0.998953844, 0.037393998, 0.567138907, 0.090166963, 1.390899103, -0.795618638, 0.255920911, 0.980201572, -0.652454938], [1.929475393, -0.357846006, -0.865760258, -1.733011647, -2.152476069, -0.826029199, -0.787254667, 2.082014504, 0.612146092, -0.674617352, 0.263144282, -0.627371137, 1.754220083, -0.63650094, -0.707312518, -0.816433396, -1.03214367, 0.408654119, -1.922759041, 0.836347478, -1.121819946, -0.667053355, 0.090166963, -1.232557205, -0.749571735, -1.686988862, -1.203241451, -0.709466379], [-0.251668746, -0.278724803, 0.736542309, -0.046493209, -0.469751222, 0.335298574, 0.62839759, -0.584736246, -0.221987044, 0.780209634, 0.986343829, -0.399425251, -0.298938515, 0.749664306, 0.500238214, 0.385631572, 0.762049999, -0.266987358, 1.06140776, 0.001126895, 1.0517062, 1.041828238, 0.090166963, 0.499741686, 0.457581827, 0.255920911, 0.980201572, -0.426773415], [1.929475393, -0.516088411, -0.865760258, 1.349242044, 0.228359589, -0.826029199, -0.153924413, 0.354872472, -0.221987044, 0.780209634, -1.485733761, -0.8823544, -1.035967231, -0.828431513, -0.707312518, -0.816433396, 0.762049999, -0.266987358, -2.315882812, -0.350336401, 1.196607943, -0.643318888, 0.090166963, 0.202003016, -1.138502937, 0.255920911, -1.203241451, -0.709466379], [-0.478867648, 0.295716807, -2.468062826, 0.321824147, 0.331413264, -0.44636435, 1.424557836, -0.190311234, -0.221987044, -2.129444339, 0.109307723, -0.017990255, 0.20411602, -0.529872844, -0.075212815, -0.492472624, 0.762049999, -0.266987358, 0.260269168, -0.450837316, 1.0517062, -0.453443156, 0.090166963, -0.090222639, 0.179540884, 0.255920911, -1.203241451, 0.122898858], [7.709517765, -0.521507672, -0.865760258, -1.733011647, 0.228359589, -0.840918016, -0.365188256, -0.888146407, 2.280412365, -0.674617352, -0.028335537, -0.869459651, -1.035967231, -0.785780274, -2.12953685, -0.833483963, 0.163985443, 3.111220026, -2.598812798, -0.449581054, 0.327197484, -0.643318888, 0.090166963, -1.232557205, 0.028290087, -0.39171568, -1.203241451, -0.709466379], [-0.532387923, 1.123779806, -0.064608974, 0.435984773, -0.549991428, -0.245365312, 2.455045664, -0.320913024, -0.221987044, 0.052796141, -0.443963837, 1.273148488, -0.93262417, 1.005571737, 0.820264609, -0.21113827, -1.03214367, -0.266987358, 0.887182453, -1.004848609, 0.037393998, -0.382239756, 0.090166963, 1.034402281, -0.540701782, -1.686988862, 0.980201572, -0.59848195], [0.333499561, 0.022586079, 0.736542309, -0.007869449, -1.2331579, 0.149188354, -0.095803793, -0.544680662, -0.221987044, 0.780209634, -0.56017722, -0.685605487, 0.21337387, -0.167337318, -0.155400747, 0.121347785, -1.03214367, -0.266987358, 0.893138874, -0.87526041, 1.776214915, -0.358505289, 0.090166963, -0.140578572, -0.811975326, 0.903557502, 0.980201572, -0.239863627], [0.123215945, 0.031256896, 0.736542309, -0.41204578, -0.563744891, -0.431475532, 0.319343497, -0.069436218, -0.221987044, -2.129444339, -0.004913251, -0.263822406, 2.102996636, -0.465895987, -1.13905759, -0.449846207, -0.434079113, -0.266987358, 0.879736927, -0.321442388, 0.037393998, -0.453443156, 0.090166963, -1.616814202, -0.252990457, -1.039352271, 0.980201572, 0.414221746], [0.360610837, -0.552939382, -0.865760258, 0.732796854, 0.194252247, -0.066699501, 0.000602633, -0.418603023, -0.221987044, -2.129444339, -0.124107597, -0.419807273, 0.797589455, -0.188662937, -1.154298162, -0.066208451, 0.762049999, -0.266987358, 1.14181944, -0.135032518, 1.486411429, 0.044980642, 0.090166963, -1.013957484, -0.060608457, 0.255920911, 0.980201572, 0.489131291], [-0.5992861, -0.168171889, 0.736542309, 0.386042967, 1.346997887, -0.491030803, -0.049676316, 0.013451173, -0.221987044, 0.780209634, -0.401794015, -0.711810945, -0.86158314, -0.487221606, 0.892691456, -0.458371491, 1.360114555, -0.266987358, 0.684664147, -0.583421215, 0.617000971, -0.263567423, 0.090166963, 1.068716961, 0.076906269, 0.903557502, 0.616294402, -0.709466379], [-0.620536415, 1.598507022, 0.736542309, -0.645156859, 1.437885936, -0.468697576, -0.787254667, -0.023805714, -0.221987044, 0.780209634, 0.168841718, 3.906173051, -0.871837088, -0.209988557, 1.38419561, -0.441320924, 0.762049999, -0.266987358, 0.74571746, -0.870718542, -0.976918203, -0.073691691, 0.090166963, 1.242762111, 0.680321449, 0.255920911, 0.252387231, -0.709466379], [-0.38253462, -0.578951833, 0.736542309, -1.11655721, -0.090336235, -0.625030161, -0.787254667, 0.096455401, -0.221987044, 0.780209634, 1.487358913, -0.087455516, 0.638146831, -0.337942272, 0.572690661, -0.603301309, -1.03214367, -0.266987358, -0.357709486, -0.353428737, -1.411623433, -0.263567423, 0.090166963, 0.058546994, 1.039510514, 0.903557502, -1.203241451, -0.409819209], [-0.368939967, 1.594171614, -0.064608974, -0.384074299, -0.57589495, 2.315511313, 3.869314097, -0.776528696, -0.221987044, 0.052796141, -0.977873568, 1.949914833, -0.858712034, 0.66436183, 1.022786712, 1.425716154, -0.434079113, -0.266987358, 1.000354447, 0.260496563, 0.472099227, -0.073691691, 0.090166963, 0.998605699, -0.902398868, 0.903557502, 0.980201572, -0.47680001], [0.165439133, 1.257093613, 0.736542309, 0.428568863, 0.041275138, -0.275142948, 1.880297305, -0.288132771, -0.221987044, -0.674617352, 0.289642408, 1.152104231, -0.166298458, -0.103360461, 0.031509584, -0.219663554, -1.03214367, -0.266987358, 0.90654082, -0.849072191, 0.327197484, -0.002488291, 0.090166963, 0.22063365, 0.202551209, -1.686988862, 0.616294402, -0.475972976], [0.207766363, -0.684085486, -0.064608974, -0.290256568, 0.255197132, 0.201299215, 1.473452961, -0.617688879, -0.221987044, -2.129444339, -0.056243259, -0.215987046, -0.620410268, 0.237849446, 0.351791979, 0.334479871, 1.360114555, -0.266987358, 0.294518587, -0.649906436, 0.906804457, 0.377263174, 0.090166963, 0.405486776, 0.01587716, 0.903557502, -0.47542711, -0.008159136], [-0.790538937, 0.916764056, 0.736542309, 0.261387256, 2.295761076, -0.468697576, 1.472530412, 0.021989712, -0.221987044, 0.780209634, -0.045481537, 0.115948751, -1.035967231, -0.572524083, 1.049555846, -0.535099042, 1.360114555, -0.266987358, 0.922920977, -0.74055053, -0.83201646, -0.358505289, 0.090166963, 1.186505832, 0.783274015, 0.903557502, 0.980201572, -0.533200165], [-0.740113872, 3.327251111, 0.736542309, -0.94938485, -1.075246045, 1.786958289, -0.787254667, -0.7625139, -0.221987044, 0.780209634, -0.246945293, 2.23651103, -0.704927916, 0.92026926, 1.401923654, 1.775252776, 1.360114555, -0.266987358, 0.775499564, 2.46678155, -0.542212974, 0.946890372, 0.090166963, 1.117852083, -0.586418483, 0.903557502, 0.980201572, -0.506312555], [0.690896743, -0.833657074, -2.468062826, -1.733011647, -0.349387021, -0.69202984, -0.271088204, -0.221776131, -0.221987044, -2.129444339, -0.194895184, -0.970121886, 2.950014646, -0.401919129, -1.520012137, -0.680028861, -0.434079113, -0.266987358, -1.537080797, 0.595725096, -0.252409488, -0.500912089, 0.090166963, -2.462180456, -0.305079598, -1.039352271, -1.203241451, 1.002818576], [-0.354244216, -0.130237066, -2.468062826, -0.69840901, 0.669030801, 0.216188033, -0.787254667, -0.726055286, -0.221987044, -2.129444339, -0.389118147, 0.298970996, 2.417621263, 0.067244493, -1.115083131, 0.249227037, -1.03214367, -0.266987358, -0.840179568, -0.372852471, -1.701426919, 0.163652975, 0.090166963, -1.814406223, -0.12265851, -1.686988862, -1.203241451, 0.799260224], [-0.293614492, -0.869424193, -0.064608974, 1.112145606, -1.15807816, -0.654807796, -0.33843432, 0.205659883, -0.221987044, 0.052796141, -1.138200651, -0.9297738, -0.392077851, -0.721803417, 0.003801781, -0.620351876, -1.03214367, -0.266987358, -0.441099377, -0.419720686, 0.327197484, -0.619584422, 0.090166963, 0.367529747, -1.116064341, 0.903557502, -1.203241451, -0.363712038], [-0.157754664, -0.352426745, 0.736542309, 0.321824147, 0.561937484, -0.44636435, 0.180961067, -0.060557511, -0.221987044, 0.780209634, -1.194254378, -0.378627268, -1.035967231, -0.615175321, 0.556891155, -0.475422057, 1.360114555, -0.266987358, 0.791879721, -0.430640497, -0.542212974, -0.429708689, 0.090166963, 0.813019513, -0.846804681, 0.903557502, 0.980201572, -0.210045439], [-0.277444832, 0.623040139, -0.064608974, -0.163862464, -0.018642323, 0.379965026, -0.787254667, -0.606950551, -0.221987044, 0.052796141, 2.094166253, 0.536483954, -0.579394473, 2.178480791, 0.766632476, 0.368581005, -1.03214367, -0.266987358, 0.921431872, -0.783166783, 0.472099227, 2.513365166, 0.090166963, 0.775827105, 1.545121019, -1.686988862, 0.980201572, -0.546019199], [0.773470387, -0.778380618, -2.468062826, -0.577165357, 0.586113067, -0.550586073, -0.14193127, -0.306217302, -0.221987044, -2.129444339, -0.45462456, -0.794586915, 1.893732378, -0.615175321, -1.276201398, -0.535099042, -1.03214367, -0.266987358, -0.832734042, 1.354893545, -0.397311231, -0.477177622, 0.090166963, -1.662925271, -0.205068518, -1.686988862, -0.47542711, 0.414221746], [-0.010398338, -0.477069736, -0.064608974, 0.673682251, -0.735316805, -0.304920583, -0.234186223, -0.264396482, -0.221987044, 0.052796141, -1.711331158, -0.832023283, -0.577301831, -0.700477798, 0.091473466, -0.475422057, -1.03214367, -0.266987358, 0.855911244, -0.059077019, 1.486411429, -0.619584422, 0.090166963, 0.398517683, -1.402230248, 0.255920911, 0.980201572, -0.216886452], [0.231591685, -0.211525973, 0.736542309, 0.694265562, -0.466544416, -0.252809721, -0.787254667, -0.469854197, -0.221987044, 0.052796141, 0.589237022, 2.029779085, 1.789100249, 0.088570112, -1.276201398, -0.219663554, 0.762049999, -0.266987358, -0.059888448, -0.686241382, -0.397311231, -0.14489509, 0.090166963, -1.340149221, 0.188724128, 0.255920911, -0.47542711, -0.147622316], [-0.64463051, 0.357496376, 0.736542309, -0.572486491, -0.056213326, 0.990406548, -0.787254667, -0.710235528, -0.221987044, 0.780209634, -0.093830145, -0.12905148, -0.798745268, 0.259175065, 1.256165425, 1.093230099, 1.360114555, -0.266987358, 0.735293723, -1.007747674, 0.182295741, 0.377263174, 0.090166963, 1.11965676, -0.127596961, 0.903557502, 0.980201572, -0.563890335], [-0.960541458, -0.409870906, 0.736542309, -0.191880178, -1.867202638, -0.759029519, -0.280313699, 2.590670923, -0.221987044, 0.780209634, 2.522111463, -0.841174395, -0.338422495, 0.301826304, 0.714916081, -0.739705845, -1.03214367, -0.266987358, 0.568513942, 0.231989092, -1.991230405, -0.405974223, 0.090166963, 0.560643071, 0.368604525, 0.903557502, -0.47542711, 0.039656041], [-0.504218901, 0.150480626, 0.736542309, -0.272992848, 2.313756552, -0.706918658, -0.787254667, 0.952623396, -0.221987044, 0.780209634, -0.994820633, 0.076016625, -0.595407374, -0.679152179, 0.789770667, -0.705604711, -1.03214367, -0.266987358, 0.054772651, 0.001126895, -2.425935634, -0.524646556, 0.090166963, 0.730525127, -0.309465573, -1.686988862, 0.980201572, -0.236330752], [-0.960541458, -0.706846379, 0.736542309, -1.733011647, 0.747262862, -0.840918016, -0.787254667, -0.888146407, 3.114545502, 0.780209634, 0.408883974, -0.971785724, -1.035967231, -0.764454655, 2.137140413, -0.833483963, 1.360114555, 3.786861503, -2.598812798, 2.574336856, -1.121819946, -0.619584422, 0.090166963, 1.636563237, 0.611686599, 0.903557502, -1.203241451, -0.709466379], [-0.960541458, -0.780548322, -0.064608974, 2.890373513, 2.044509368, -0.833473607, -0.787254667, -0.044202006, 3.948678638, 0.052796141, 0.408883974, -0.877362885, -1.035967231, -0.743129036, 0.003801781, -0.824958679, 1.360114555, 3.111220026, -2.470749752, 1.372964382, -1.121819946, -0.595849955, 0.090166963, 0.919283127, 1.195083112, 0.903557502, -1.203241451, -0.709466379], [-0.136174887, -0.45322499, -0.064608974, 0.389196115, 0.204339677, 1.422182258, 1.15009935, -0.756422878, -0.221987044, 0.052796141, 0.10784741, -0.036708439, -0.404742524, 2.22113203, 0.22063432, 1.655898808, 0.163985443, -0.266987358, 0.449385527, -0.066614587, 0.472099227, 1.160500571, 0.090166963, 0.39014272, 0.127754525, 0.903557502, 0.616294402, -0.267362523], [-0.960541458, -0.83148937, -1.666911542, -1.733011647, 2.822860385, -0.833473607, -0.787254667, -0.122708462, 5.616944912, -1.402030846, 1.06471324, -0.625707298, -1.035967231, -0.721803417, -2.12953685, -0.824958679, -0.434079113, 4.46250298, -2.482662593, 1.570004157, -1.121819946, -0.548381022, 0.090166963, -2.667117426, 2.361876136, -1.039352271, -1.203241451, 8.280038623], [3.374488154, -0.722020309, -0.865760258, -1.733011647, 2.719082844, -0.833473607, -0.787254667, 0.004864529, 7.285211185, -0.674617352, 3.250810794, -0.62321154, -1.035967231, -0.593849702, 0.003801781, -0.824958679, 1.360114555, 7.165068887, -2.463304226, 1.338368875, -1.121819946, -0.382239756, 0.090166963, 0.202003016, 4.987160441, 0.903557502, -1.203241451, -0.709466379], [0.854119278, -0.630976733, 0.736542309, -1.087892222, 0.381834842, -0.528252847, -0.787254667, -0.234990946, -0.221987044, 0.780209634, -0.048671491, 0.827655707, 1.883997405, -0.529872844, -0.938835226, -0.509523191, 1.360114555, -0.266987358, -0.46790327, 0.851615886, -1.121819946, -0.429708689, 0.090166963, -1.466090698, 0.068991912, -0.39171568, -1.203241451, 0.126764345], [0.773470387, -0.962635473, -0.064608974, 1.965696481, 2.634172531, -0.811140381, -0.787254667, 2.554361687, -0.221987044, 0.052796141, -0.290667244, -0.94100471, 0.638146831, -0.551198463, -1.276201398, -0.799382829, -1.03214367, -0.266987358, -1.292867546, 1.750519261, -1.121819946, -0.382239756, 0.090166963, -0.658733116, 0.611686599, -1.686988862, -1.203241451, -0.709466379], [-0.740113872, -0.148662552, 0.736542309, -0.975506976, -1.066466246, 1.786958289, 0.294895934, -0.7625139, -0.221987044, 0.780209634, -0.232124426, -0.337447263, -0.681281055, 0.92026926, 1.401923654, 1.766727493, 1.360114555, -0.266987358, 0.775499564, -1.030940192, 1.0517062, 0.946890372, 0.090166963, 1.10569562, -0.5748824, 0.903557502, 0.980201572, -0.506312555], [0.047604359, -0.570281016, 0.736542309, 0.503412222, 0.296379684, 0.752185466, -0.203742088, -0.718992374, -0.221987044, 0.780209634, -0.166618887, -0.713890743, 0.599215309, 0.152546969, -0.581624739, 0.888623296, -1.03214367, -0.266987358, 0.16049912, -0.517515807, -0.107507745, 0.234856375, 0.090166963, -0.525286021, -0.058540899, -1.686988862, 0.616294402, 0.043143969], [1.929475393, -0.63964755, 0.736542309, -0.70559375, 0.328790221, -0.781362746, -0.164995008, 1.86612175, -0.221987044, -0.674617352, -0.70845497, -0.883602279, -0.105904793, -0.743129036, -0.707312518, -0.773806979, 1.360114555, -0.266987358, -0.718072942, 0.579683603, 0.182295741, -0.572115489, 0.090166963, -0.594975522, -0.490284655, -1.686988862, -1.203241451, 0.289366511], [-0.761225466, 0.188415449, 0.736542309, -1.307872888, 0.661729868, -0.20069886, 0.305505254, -0.352588004, -0.221987044, -2.129444339, -0.842468434, -0.254671294, -0.84353619, -0.295291033, 1.695761184, -0.228188837, 1.360114555, -0.266987358, 0.936322924, -1.000500012, 1.196607943, -0.073691691, 0.090166963, 1.323268196, -0.521578044, 0.903557502, 0.980201572, -0.606141008], [-0.504218901, -0.33942052, 0.736542309, 1.673692721, -0.440874399, -0.565474891, -0.14193127, 0.116942819, -0.221987044, 0.780209634, -0.983315202, -0.787931561, -1.035967231, -0.572524083, 0.003801781, -0.543624325, -0.434079113, -0.266987358, 0.298985903, 0.773727677, -0.542212974, -0.548381022, 0.090166963, 0.617270902, -0.877510006, 0.255920911, 0.980201572, 0.000228072], [-0.26693672, -1.001654149, -2.468062826, 0.116342417, -1.270689986, -0.662252205, -0.349504914, -0.173737658, -0.221987044, -2.129444339, -0.325644804, -0.981768756, 1.977438081, -0.38059351, -1.105534307, -0.645927727, -1.03214367, 0.408654119, -1.243727075, -0.479441422, -1.266721689, -0.500912089, 0.090166963, -1.46208684, -0.695121588, -1.686988862, -1.203241451, 0.369274221], [0.278037193, -0.957216213, 0.736542309, 2.229885955, 0.31484217, -0.796251563, -0.523866776, 0.143652737, 0.612146092, 0.780209634, -1.090154162, -1.002566738, 1.355621895, -0.764454655, -1.520012137, -0.790857546, -1.03214367, 0.408654119, -2.050822088, 0.984296421, -0.83201646, -0.643318888, 0.090166963, -1.027620235, -0.805133252, -1.686988862, -1.203241451, -0.709466379], [-0.836680992, 2.211967307, 0.736542309, -0.808334615, 0.385695464, -0.327253809, 2.485489798, -0.230654839, -0.221987044, 0.780209634, 1.864200158, 1.243199394, -0.796811667, 2.327760126, 1.405708197, -0.296391105, -1.03214367, -0.266987358, 0.893138874, -1.041086919, 1.631313172, 1.492783103, 0.090166963, 1.165208351, 1.653465919, 0.903557502, 0.980201572, -0.452627232], [-0.471099275, -0.160584925, 0.736542309, 0.019399277, -0.273941457, 0.997850956, -0.787254667, -0.759465455, -0.221987044, 0.780209634, -0.946848909, 0.222850381, -0.765949374, 0.344477542, 0.846816142, 1.152907083, -1.03214367, -0.266987358, -0.177527758, -0.978563754, -0.107507745, -0.405974223, 0.090166963, 0.91349898, -0.816223619, -1.686988862, -1.203241451, -0.491974295], [0.002797492, 0.481055514, -0.865760258, -0.70559375, 0.157062636, 0.022633404, 2.162597462, -0.534196361, -0.221987044, -0.674617352, 0.233248961, 0.078928343, -0.320534587, -0.082034842, 0.714916081, 0.044620234, 1.360114555, -0.266987358, 0.543199154, -0.856126582, 1.0517062, 0.068715109, 0.090166963, 0.557577416, 0.207796527, 0.903557502, 0.980201572, -0.478966481], [-0.450533894, 0.246943462, 0.736542309, -0.781139864, -0.268399597, -0.342142627, 2.024215032, -0.196885522, -0.221987044, 0.780209634, 1.251174682, 0.578495878, -0.543576803, 0.515082495, 1.070471097, -0.347542806, -0.434079113, -0.266987358, 0.967594133, -0.986004687, -0.107507745, 0.638342307, 0.090166963, 0.855993199, 0.757535728, -1.039352271, 0.616294402, -0.445067058], [-0.418662756, 2.202212638, 0.736542309, -1.039503873, 1.702439663, 0.342742982, -0.787254667, -0.6050325, -0.221987044, 0.780209634, 1.029189155, 0.952027641, -0.879019038, 7.829769874, 1.363805159, 0.308904021, 1.360114555, -0.266987358, 0.838041982, -1.068628036, 1.0517062, 8.660592009, 0.090166963, 1.13446716, 1.694616375, 0.903557502, 0.980201572, -0.484728754], [-0.293614492, -0.610383543, 0.736542309, -0.310433021, -0.380785701, -0.654807796, -0.049676316, 0.327948781, -0.221987044, 0.780209634, 1.653278033, -0.721378017, -0.392077851, 0.173872589, 0.496112338, -0.637402443, -1.03214367, -0.266987358, -0.199864336, 0.077275665, -1.266721689, 0.021246176, 0.090166963, 0.422704368, 0.970700062, 0.903557502, -1.203241451, -0.017966686], [0.612163935, 0.943860358, 0.736542309, -0.356750093, -0.079556073, 0.752185466, 2.026060131, -0.667506761, -0.221987044, 0.780209634, -1.289154622, 1.1184115, -0.140508731, -0.444570368, 0.013726073, 0.146923635, -1.03214367, -0.266987358, 1.000354447, 1.393837649, 0.182295741, -0.311036356, 0.090166963, 0.028521649, -1.029963766, 0.903557502, 0.980201572, -0.165915959], [0.073501825, 2.072150387, 0.736542309, 0.642307959, -0.65086572, -0.036921866, -0.787254667, -0.481209272, -0.221987044, 0.780209634, 0.725767996, 2.075118687, -0.805584024, 0.728338687, 0.101662291, -0.006531467, 1.360114555, -0.266987358, 0.766564932, -0.835929763, 0.617000971, 0.899421439, 0.090166963, 0.452064077, 0.188857726, 0.903557502, 0.980201572, -0.049690649], [-0.960541458, 2.465588697, -0.064608974, 5.664404608, -0.424451193, -0.811140381, -0.787254667, 2.95081929, -0.221987044, 0.052796141, 0.496327876, 1.408335373, -1.035967231, -0.615175321, -1.276201398, -0.799382829, 0.762049999, -0.266987358, -1.142467922, 1.394900639, -0.83201646, -0.500912089, 0.090166963, 0.48891506, 0.14496939, 0.255920911, -1.203241451, -0.709466379], [0.278037193, -0.494411369, 0.736542309, 2.229885955, 0.812122852, -0.796251563, 2.252084767, 1.803503509, -0.221987044, 0.780209634, 0.283964238, 1.367571328, 0.159827332, -0.572524083, -1.520012137, -0.782332262, -0.434079113, -0.266987358, -1.169271815, 1.285799166, -1.846328662, -0.477177622, 0.090166963, -0.822683266, 0.528344324, -1.039352271, -1.203241451, 0.574747337], [0.333499561, 0.801875734, 0.736542309, -0.007869449, -1.2331579, 0.149188354, 0.869644293, -0.544680662, -0.221987044, 0.780209634, -0.56017722, 0.367188378, 0.21337387, -0.167337318, -0.155400747, 0.121347785, -1.03214367, -0.266987358, 0.893138874, 0.311326834, 1.631313172, -0.358505289, 0.090166963, -0.140578572, -0.811975326, 0.903557502, 0.980201572, -0.239863627], [-0.093535536, 0.568847534, -0.064608974, 0.578680933, 0.348108893, -0.699474249, 2.162597462, 0.882174175, -0.221987044, 0.780209634, 0.627493729, 0.527332842, 0.219618316, 0.024593254, 0.003801781, -0.671503577, 0.762049999, -0.266987358, 0.087532966, -0.960589552, 0.327197484, 0.211121908, 0.090166963, 0.130275005, 0.611686599, 0.255920911, -1.203241451, -0.709466379], [-0.075839945, -0.461895806, 0.736542309, -0.223337691, -0.716309474, -0.483586394, -0.787254667, -0.224446411, -0.221987044, 0.780209634, -1.170460018, 0.068945311, 0.50148053, -0.572524083, -0.300962709, -0.492472624, -1.03214367, -0.266987358, -0.131365497, -0.328400144, 0.182295741, -0.548381022, 0.090166963, -0.471362337, -1.055160662, -1.686988862, 0.616294402, 0.391289519], [-0.566443916, 0.037760008, 0.736542309, -0.719325204, -0.562694117, 1.935846465, -0.787254667, -0.730503756, -0.221987044, 0.780209634, 0.293149346, -0.463483036, -0.722631673, 0.429780019, 1.235890175, 1.869030894, 1.360114555, -0.266987358, 1.874459194, -1.054905795, -0.397311231, 0.472201041, 0.090166963, 1.053533576, -0.054383616, 0.903557502, 0.980201572, -0.541209814], [-0.172355044, -0.263550873, -0.064608974, -0.556147448, 0.61867149, -0.438919941, 0.596108356, -0.04562939, -0.221987044, 0.052796141, 0.512226926, -0.607405074, -0.731579812, 0.088570112, 0.818348871, -0.373118656, 0.762049999, -0.266987358, 0.916964557, -0.974311792, 0.761902714, 0.211121908, 0.090166963, 0.749743931, 0.643507962, 0.255920911, -1.203241451, -0.219133829], [-0.136174887, -0.646150662, -0.064608974, 0.389196115, 0.204339677, 1.422182258, -0.787254667, -0.756422878, -0.221987044, 0.052796141, 0.10784741, -0.130715319, -0.404742524, 2.22113203, 0.22063432, 1.655898808, 0.163985443, -0.266987358, 0.449385527, -0.957110674, 0.472099227, 1.160500571, 0.090166963, 0.39014272, 0.127754525, 0.903557502, 0.616294402, -0.267362523], [-0.754107348, -0.285227915, 0.736542309, -1.166887381, -1.191632873, 1.340293761, -0.016464533, -0.718916929, -0.221987044, 0.780209634, -0.419453748, -0.669799021, -0.808195642, 0.429780019, 1.585663844, 1.374564453, -1.03214367, -0.266987358, 1.17606886, -1.03055365, 0.327197484, 0.211121908, 0.090166963, 1.251086864, -0.721790976, 0.903557502, 0.980201572, -0.556581867], [-0.471099275, 0.26103354, 0.736542309, -0.017883701, -0.409452369, 0.997850956, 2.026060131, -0.759465455, -0.221987044, 0.780209634, -0.94508604, 0.496551828, -0.732199235, 0.344477542, 0.846816142, 1.135856517, -1.03214367, -0.266987358, -0.177527758, -0.103529347, 0.182295741, -0.405974223, 0.090166963, 0.896145105, -0.844452426, -1.686988862, -1.203241451, -0.491974295], [-0.30205913, -0.515004559, -2.468062826, 0.022700374, 0.177735639, -0.26025413, -0.787254667, -0.310527699, -0.221987044, -2.129444339, -0.172230599, -0.253423415, -0.506185465, -0.487221606, 0.624901991, -0.21113827, 0.762049999, -0.266987358, 0.86335677, -1.03528879, 1.486411429, -0.334770823, 0.090166963, 0.674136869, -0.104635641, 0.255920911, 0.980201572, -0.48188807], [-0.62274728, 0.141809809, 0.736542309, -0.41204578, -0.136220028, 4.883832348, -0.787254667, -0.851824434, -0.221987044, 0.780209634, -0.660316665, -0.336615344, -0.927258635, 0.749664306, 1.233936037, 5.210942011, 1.360114555, -0.266987358, -0.476837902, -1.055775515, 1.0517062, 0.851952506, 0.090166963, 1.172659457, -0.574805392, 0.903557502, 0.980201572, -0.557696566], [-0.08097262, -0.361097562, 0.736542309, 0.277152999, 0.537178138, -0.334698218, -0.787254667, -0.231081501, -0.221987044, 0.780209634, -0.649314036, -0.093278951, -0.79333788, -0.487221606, 0.591242174, -0.270815254, -1.03214367, -0.266987358, 0.841020192, -0.921258906, 1.0517062, -0.453443156, 0.090166963, 0.804934331, -0.386006029, 0.255920911, 0.616294402, -0.579181483], [-0.850327665, -0.149746404, -0.064608974, -0.92980019, -0.393239317, 2.665398527, 1.010333096, -0.806853973, -0.221987044, 0.780209634, -0.880543258, -0.255503213, -0.94729778, 0.941594879, 1.639965845, 2.866489059, 0.762049999, -0.266987358, 0.312387849, -1.026011782, 1.486411429, 0.567138907, 0.090166963, 1.387338524, -0.796128527, 0.255920911, 0.980201572, -0.652329085], [-0.960541458, 2.790744325, -2.468062826, -1.733011647, 1.494830096, -0.796251563, -0.787254667, 3.581113985, 0.612146092, -2.129444339, 1.470702598, 3.073837798, 0.159827332, -0.273965414, 1.5276157, -0.782332262, 1.360114555, 1.759937073, -0.225179124, 0.844851402, -0.687114717, -0.14489509, 0.090166963, 0.816813925, 2.028506451, 0.903557502, -1.203241451, -0.709466379], [-0.960541458, -0.789219139, -2.468062826, 0.578680933, 1.703132395, -0.81858479, -0.315370582, 4.484639173, 1.446279229, -2.129444339, -0.137640415, -0.92935784, 1.056675347, -0.785780274, -1.062867534, -0.807908112, 0.762049999, 2.435578549, -0.968242614, 0.728115724, -0.83201646, -0.595849955, 0.090166963, -1.232557205, 0.465837471, 0.255920911, -1.203241451, 1.537909871], [-0.313520948, -0.235370719, -0.865760258, -0.559910884, -0.349846248, 0.149188354, -0.188058746, -0.529594528, -0.221987044, -0.674617352, -0.501446398, -0.755902668, -0.286365918, -0.401919129, 0.7361428, 0.181024769, -1.03214367, -0.266987358, 1.046516708, -0.676771103, 0.037393998, -0.21609849, 0.090166963, 0.565995416, -0.52027707, 0.903557502, 0.980201572, -0.374040979], [-0.341247798, -0.788135286, 0.736542309, -0.610185574, -0.21554178, 0.193854806, 0.455880827, -0.554213584, -0.221987044, 0.780209634, 0.1840281, -0.462651117, -0.677229699, 0.643036211, 0.857137234, 0.240701753, 1.360114555, -0.266987358, 0.948235766, -1.039250845, -0.252409488, 0.851952506, 0.090166963, 0.734840284, 0.015788483, 0.903557502, 0.980201572, -0.13156706], [-0.9605414580000001, -0.7299685576666667, -1.9339619700000001, -0.345996099, 2.423008495, -0.8210662593333332, -0.629959972, 2.1798204696666663, 2.280412365666667, -1.6445020103333334, -0.050196512666666686, -0.7417600396666666, 0.21961831566666667, -0.7360204963333333, -1.4895352606666667, -0.8107498733333333, -0.23472426133333332, 2.210364723666667, -1.6289089503333332, 1.56478584, -0.3973112306666667, -0.556292511, 0.090166963, -1.8063812933333334, 0.8353219289999999, -0.8234734073333333, -1.203241451, 4.234761372], [-0.5852958759375, 0.3264711096875, 0.43611057787499996, -0.621202523, -0.6201232871875, 2.1280052668750002, 0.34004320187500003, -0.7723603695, -0.221987044, 0.6438196040624999, -0.45252445825, 0.3602730489375, -0.732402743875, 0.9042750455, 1.182277775125, 2.0517916584375, 0.46301772087500004, -0.266987358, 0.6070445388125, -0.11635166881250004, 0.40870471475, 0.6324086899375, 0.090166963, 1.028458808, -0.5540546340625, 0.7821256411874999, 0.93471317575, -0.49361544125], [-0.33589608957894734, 1.199820586631579, 0.35704959578947365, -0.36368079068421055, 0.520810645631579, -0.2167631102631579, 0.2326723959473684, 0.06751951031578947, -0.1780853, 0.24422074431578944, 0.8837998143157895, 1.0413495019473684, -0.5888941895263158, 0.8899644325789473, 0.8336705092631579, -0.2017155885263158, 0.6046645893157895, -0.1247470470526316, 0.5867750742105263, -0.6375574364210527, 0.1517901112631579, 1.0468249682105264, 0.090166963, 0.7734040568947368, 0.9081029981052632, 0.32409318373684204, 0.23323422205263158, -0.4221953914736842], [-0.10576502571428571, -0.029841394999999993, 0.46186186902857135, 0.1785348729714286, -0.24704364691428574, -0.16177523662857143, 0.13753534239999998, -0.20379490554285712, -0.221987044, 0.40611126614285714, -0.6936256214, -0.15179853071428573, -0.1997661505142857, -0.3312399342857143, 0.13008275037142858, -0.1638838418, -0.6220422599142857, -0.266987358, 0.4866982484285714, -0.2685606840285714, 0.21955618942857144, -0.3503677580857143, -0.2292817076571428, 0.2033433052857143, -0.6311832637142857, -0.1881727514, 0.5331156198, -0.12343874999999999], [-0.044371964750000006, -0.47734069881249996, -0.66547243725, 0.5156381865625, -0.2680649063125, 0.09289001231249999, -0.213717154875, -0.43295726625000003, -0.221987044, -0.9019340690625, 0.0213814311875, -0.1657599191875, 0.33206489525000005, -0.1153561213125, -0.4837327626875, 0.121347784625, 0.7246709641875, -0.266987358, 0.062404315500000015, 0.044655145437500016, 0.5807755348125, -0.0914925405, 0.090166963, -0.3921854614375, -0.11634827425000001, 0.255920911, -0.1342641375625, 0.2072771608125], [0.378169283, -0.5296858283636363, -1.5940796071818184, -0.6302384564545455, -0.22706208227272728, -0.5262225534545455, -0.11869979490909092, 0.06451467327272724, -0.14615675890909088, -1.534287844363636, -0.48076579536363634, -0.4282020952727273, 2.186914647272727, -0.5027311470909092, -1.2341362266363636, -0.5133983201818182, -0.5428181237272727, -0.08272150063636365, -0.8920275033636365, 0.23046049445454544, -0.7134604885454544, -0.4599161921818182, 0.090166963, -1.7526165842727273, -0.48142042245454547, -1.2159804321818182, -0.6739219302727273, 0.47219588127272727], [0.48446841266666657, -0.7364716699999999, -0.06460897433333335, -0.19188326033333336, 1.8369516913333335, -0.8359550766666667, -0.787254667, -0.3091612946666667, 4.782811775, 0.052796141, 1.356192914, -0.8241200496666666, -1.035967231, -0.7004777976666666, 0.7149146583333333, -0.8278004403333333, 1.360114555, 4.687716805333333, -2.510955592, 1.7618900376666666, -1.121819946, -0.5325580443333333, 0.090166963, 0.9192831266666667, 2.264643384, 0.903557502, -1.203241451, -0.7094663789999999], [0.8298497176190477, -0.4339221000476191, 0.20244145347619047, 0.5188811883809523, 0.12761613404761907, -0.7140085709523809, -0.2713517893809524, 0.895875915952381, -0.06310454185714284, 0.32990604309523813, 0.7501630121428571, -0.3893827962857143, 0.14186647966666666, -0.3856710383333334, -0.7461902780952381, -0.6970794274285714, -0.29168279066666664, 0.022573274952380925, -0.7934500290000001, 0.4831079302380953, -0.6664144681904761, -0.37884911795238096, 0.090166963, -0.47866616114285715, 0.550458691, -0.14499697866666666, -1.0126234092857143, 0.05492578561904763]]
    return attribute

def avg_community(f, attribute):
    avg_community = [[0.0] * dimension for i in range(communitycount + 1)]  # 用来存储每个社团的属性均值
    sum_community = [[0.0] * dimension for i in range(communitycount + 1)]  # 用来存储每个社团的属性均累加
    count = [0] * (communitycount + 1)  # 计数每个社团几个节点， 社团数加一
    for i in range(node):
        for j in range(communitycount):
            if f[i] == j + 1:
                count[j + 1] = count[j + 1] + 1
                for k in range(dimension):  # 维数
                    sum_community[j + 1][k] = sum_community[j + 1][k] + attribute[i][k]
                    # 对属于某个社团的全部属性向量值进行加和
    for i in range(communitycount):
        for j in range(dimension):
            if count[i + 1] == 0:
                avg_community[i+1][j] = 0.0
            else:
                avg_community[i + 1][j] = sum_community[i + 1][j] / count[i + 1]
    return avg_community
# 属于某个社团的全部属性向量进行平均
# 用rbf将每个节点和社团的均值的距离变为0-1
def rbf(f, attribute, avg_community):
    # 计算节点与自身社团的属性差距
    rbflist = []
    rbf = [0] * node
    for i in range(node):
        for j in range(communitycount):
            if f[i] == j + 1:
                rbfa = np.tile(attribute[i], (1, 1))
                rbfb = avg_community[j + 1]
                diff = rbfa - rbfb
                squaredDiff = diff ** 2  # 平方
                squaredDist = np.sum(squaredDiff, axis=1)  # 和  (axis=1表示行)
                distance = squaredDist ** 0.5  # 开根号
                rbflist.append(distance)
            if f[i] == 0:
                rbflist.append(np.array([0.0]))
                break
    rbflist = np.array(rbflist)
    for i in range(len(rbflist)):
        rbf[i] = math.exp(-rbflist[i] / (2 * 9))
    return rbf
# rbf和structure都是从0开始计数的。

def outliernode(structure, rbf, balance,f):
    match = [0] * node   # 匹配分数
    outlier = [0] * node  # 异常分数
    count = 0
    maxoutlier = 0  # 异常最大的那个节点的ID
    for i in range(node):
        match[i] = balance * structure[i] + (1 - balance) * rbf[i]
    for i in range(node):
        outlier[i] = 1 - match[i]
    for i in range(node - coresite):
        if outlier[i] > limit and f[i] != 0:
            count = count + 1
    outliernode = [0] * count
    outliercount = 0
    for i in range(node - coresite):
        if outlier[i] > limit and f[i] != 0:
            outliernode[outliercount] = i   # 异常节点ID列表
            outliercount = outliercount + 1  # 异常节点数量
    if outliercount != 0:
        max = outlier[outliernode[0]]
        for i in range(outliercount):
            a = outlier[outliernode[i]]  # 异常节点的异常分数用来比大小
            if a > max:
                max = a  # 最大的异常分数
                maxoutlier = outliernode[i]  # 最大的异常分数的节点ID
            else:
                maxoutlier = outliernode[0]

    # 去对比调整模块和不调整时候的区别。
    d = [[0.0] * 2 for i in range(outliercount)]
    for i in range(outliercount):
        d[i][0] = outliernode[i]
        d[i][1] = outlier[outliernode[i]]
    '''
    print(sorted(d, key=(lambda x: x[1]), reverse=True))
    print(outliercount)
    '''
    return outliernode, outliercount, maxoutlier

# avg_community1计数从0开始，avg_community计数从1开始
def newavg_community(avg_community):
    avg_community1 = [[0.0] * 28 for i in range(communitycount)]
    for i in range(communitycount):
        avg_community1[i] = avg_community[i + 1]
    return avg_community1

def change(f, newavg_community, attribute, maxoutlier, b, balance):
    outlierrbf = [0.0] * communitycount
    outlierattribute1 = attribute[maxoutlier]
    initiallabel = f[maxoutlier]
    # 最大异常的异常节点的属性向量
    # 每次随机选择最大异常异常节点更改其社团标签，如果都不符合应该把他踢了设f=0
    diff = np.tile(outlierattribute1, (len(newavg_community), 1)) - newavg_community
    # 计算异常节点与其他社团属性均值的差距
    squaredDiff = diff ** 2  # 平方
    squaredDist = np.sum(squaredDiff, axis=1)  # 和  (axis=1表示行)
    distance = squaredDist ** 0.5
    for i in range(communitycount):
        outlierrbf[i] = math.exp(-distance[i] / (2 * 9))
    # 计算了异常节点和全部社团的rbf
    # 计算异常节点与全部社团的structure
    koutlierin = [0.0] * communitycount
    koutlierout = [0.0] * communitycount
    # 计算每个社团的kin
    for i in range(edge):
        for j in range(communitycount):
            if int(b[i][0]) == maxoutlier and f[int(b[i][1])] == j+1:
                koutlierin[j] = koutlierin[j] + b[i][2]
            if int(b[i][1]) == maxoutlier and f[int(b[i][0])] == j+1:
                koutlierin[j] = koutlierin[j] + b[i][2]
    # 计算每个社团的k_out
    for i in range(edge):
        for j in range(communitycount):
            if int(b[i][0]) == maxoutlier and f[int(b[i][1])] != j+1:
                koutlierout[j] = koutlierout[j] + b[i][2]
            if int(b[i][1]) == maxoutlier and f[int(b[i][0])] != j+1:
                koutlierout[j] = koutlierout[j] + b[i][2]
    outlierstructure = [0.0] * communitycount
    for i in range(communitycount):
        outlierstructure[i] = koutlierin[i]/(koutlierin[i] + koutlierout[i])
    outliermatch = [0.0] * communitycount
    for i in range(communitycount):
        outliermatch[i] = balance * outlierstructure[i] + (1 - balance)*outlierrbf[i]
    maxDistIndices = np.argmax(outliermatch)  # 求出的最大值的下标
    if outliermatch[maxDistIndices] > (1-limit):
        f[maxoutlier] = maxDistIndices + 1  # f=1就是一号社团，f=0就是异常
    else:
        f[maxoutlier] = 0
    changed = f[maxoutlier] - initiallabel
    # 经过计算修改了最大的异常节点的所属社团，将其加入了新的社团。
    # 如果和所有的社团契合度不够，我们将其判断为异常节点，其社团分配为0。
    return f, changed

def returncommon(f, newavg_community, attribute, outliers, b, balance, outliercount):
    # 把f=0的节点恢复正常
    # outliers是f=0节点的下标
    outlierrbf = [0.0] * communitycount
    outlierattribute = attribute[outliers]
    diff = np.tile(outlierattribute, (len(newavg_community), 1)) - newavg_community
    # 计算异常节点与其他社团属性均值的差距
    squaredDiff = diff ** 2  # 平方
    squaredDist = np.sum(squaredDiff, axis=1)  # 和  (axis=1表示行)
    distance = squaredDist ** 0.5
    for i in range(communitycount):
        outlierrbf[i] = math.exp(-distance[i] / (2 * 9))
    # 计算了异常节点和全部社团的rbf
    # 计算异常节点与全部社团的structure
    koutlierin = [0.0] * communitycount
    koutlierout = [0.0] * communitycount
    # 计算每个社团的kin
    for i in range(edge):
        for j in range(communitycount):
            if int(b[i][0]) == outliers and f[int(b[i][1])] == j + 1:
                koutlierin[j] = koutlierin[j] + b[i][2]
            if int(b[i][1]) == outliers and f[int(b[i][0])] == j + 1:
                koutlierin[j] = koutlierin[j] + b[i][2]
    # 计算每个社团的k_out
    for i in range(edge):
        for j in range(communitycount):
            if int(b[i][0]) == outliers and f[int(b[i][1])] != j + 1:
                koutlierout[j] = koutlierout[j] + b[i][2]
            if int(b[i][1]) == outliers and f[int(b[i][0])] != j + 1:
                koutlierout[j] = koutlierout[j] + b[i][2]
    outlierstructure = [0.0] * communitycount
    for i in range(communitycount):
        outlierstructure[i] = koutlierin[i] / (koutlierin[i] + koutlierout[i])
    outliermatch = [0.0] * communitycount
    for i in range(communitycount):
        outliermatch[i] = balance * outlierstructure[i] + (1 - balance) * outlierrbf[i]
    maxDistIndices = np.argmax(outliermatch)  # 求出的最大值的下标

    if outliermatch[maxDistIndices] > (1-limit):
        f[outliers] = maxDistIndices + 1  # f=1就是一号社团，f=0就是异常
        outliercount = 1
    else:
        f[outliers] = 0
    return f, outliercount

def continue_refreshing(f3, b3):
    changed3 = 0
    kin3, k_out3 = kinkout(f3, b3)  # 计算了kin和k_out
    structure3 = structure(kin3, k_out3)  # 通过kin和k_out计算结构契合度
    attribute3 = attribute()  # 读取属性向量
    avg_community3 = avg_community(f3, attribute3)  # 计算了社团内节点的平均属性向量（从1开始计数）
    newavg_community3 = newavg_community(avg_community3)  # 计算了社团内节点的平均属性向量（从0开始计数）
    rbf3 = rbf(f3, attribute3, avg_community3)  # 属性契合度
    outliernode3, outliercount3, maxoutlier3 = outliernode(structure3, rbf3, balance, f3)
    # 在初次社团标签分配的情况下计算出的异常节点标号以及异常节点个数
    if outliercount3 != 0:
        f3, changed3 = change(f3, newavg_community3, attribute3, maxoutlier3, b3, balance)
    for i in range(node):
        if f3[i] == 0:
            outliers = i
            f3, outliercount3 = returncommon(f3, newavg_community3, attribute3, outliers, b3, balance, outliercount3)
            # 把f=0的拉回正常社团
    if outliercount3 != 0:
        changed3 == 1

    if outliercount3 == 0:

        final = finaloutliersort(f3, newavg_community3, attribute3, b3, balance)
    return f3, changed3
    # 计算后对原来的社团分配进行了修改，将原来的最大异常的异常节点找到了新的合适的社团。

def takeSecond(elem):
    return elem[1]

def finaloutliersort(f, newavg_community, attribute, b, balance):
    outlierrbf = [0.0] * communitycount  # 用来计算最终异常节点和每个社团平均属性的rbf
    koutlierin = [0.0] * communitycount  # kin
    koutlierout = [0.0] * communitycount  # k_out
    finalcount = 0  # 最终异常节点的数量
    outlierstructure = [0.0] * communitycount  # 计算最终异常节点和每个社团的平均structure
    for i in range(node):      # 先算一下最终异常节点的个数。
        if f[i] == 0:
            finalcount = finalcount + 1
    finaloutliernode = [0] * finalcount
    outlierattribute3 = [[0.0] * dimension for i in range(finalcount)]  # 存放异常节点的属性信息
    finaloutlier = [[0.0] * 2 for i in range(finalcount)]
    count = 0
    for i in range(node):
        if f[i] == 0:
            finaloutliernode[count] = i  # 最终的异常节点的id
            outlierattribute3[count] = attribute[i]  # 最终的异常节点的属性矩阵
            count = count + 1
    for i in range(finalcount):  # 一个一个计算match
        diff = np.tile(outlierattribute3[i], (len(newavg_community), 1)) - newavg_community
        # 计算异常节点与各个社团属性均值的差距
        squaredDiff = diff ** 2  # 平方
        squaredDist = np.sum(squaredDiff, axis=1)  # 和  (axis=1表示行)
        distance = squaredDist ** 0.5
        for j in range(communitycount):
            outlierrbf[j] = math.exp(-distance[j] / (2 * 9))  # 一个节点与所有社团的RBF
    # 计算一个节点与全部社团的structure
    # 计算一个节点与每个社团的kin
    # 计算一个节点与每个社团的k_out
        for j in range(edge):
            for k in range(communitycount):
                if int(b[j][0]) == finaloutliernode[i] and f[int(b[j][1])] == k + 1:
                    koutlierin[k] = koutlierin[k] + b[j][2]
                if int(b[j][1]) == finaloutliernode[i] and f[int(b[j][0])] == k + 1:
                    koutlierin[k] = koutlierin[k] + b[j][2]
        for j in range(edge):
            for k in range(communitycount):
                if int(b[j][0]) == finaloutliernode[i] and f[int(b[j][1])] != k + 1:
                    koutlierout[k] = koutlierout[k] + b[j][2]
                if int(b[j][1]) == finaloutliernode[i] and f[int(b[j][0])] != k + 1:
                    koutlierout[k] = koutlierout[k] + b[j][2]
        for j in range(communitycount):
            if koutlierin[j] == 0:
                outlierstructure[j] = 0
            else:
                outlierstructure[j] = koutlierin[j] / (koutlierin[j] + koutlierout[j])
        outliermatch = [0.0] * communitycount
        for j in range(communitycount):
            outliermatch[j] = balance * outlierstructure[j] + (1 - balance) * outlierrbf[j]
        maxDistIndices = np.argmax(outliermatch)  # 求出的最大值的下标
        finaloutlier[i][0] = finaloutliernode[i]
        finaloutlier[i][1] = 1 - outliermatch[maxDistIndices]
    finaloutlier.sort(key=takeSecond, reverse=True)
    for i in range(finalcount):
        print(finaloutlier[i])
    return 1

if __name__ == '__main__':
    f1 = commmunitylabel()  # 初始社团标签
    b1 = b()  # 记录了邻接矩阵信息如（1 2 1）一号节点与二号节点连边权值为1
    kin1, k_out1 = kinkout(f1, b1)  # 计算了kin和k_out
    structure1 = structure(kin1, k_out1)  # 通过kin和k_out计算结构契合度
    k11 = k1(kin1, k_out1)  # 计算了节点的度
    attribute1 = attribute()  # 读取属性向量
    avg_community1 = avg_community(f1, attribute1)   # 计算了社团内节点的平均属性向量（从1开始计数）
    new_avg_community1 = newavg_community(avg_community1)  # 计算了社团内节点的平均属性向量（从0开始计数）
    rbf1 = rbf(f1, attribute1, avg_community1)  # 属性契合度
    outliernode1, outliercount1, maxoutlier1 = outliernode(structure1, rbf1, balance, f1)
    # 在初次社团标签分配的情况下计算出的异常节点标号以及异常节点个数
    # ADRC-BR只运行到这里就可以了，result直接用

    f2, changed2 = change(f1, new_avg_community1, attribute1, maxoutlier1, b1, balance)
    # 计算后对原来的社团分配进行了修改，将原来的最大异常的异常节点找到了新的合适的社团。
    counti = 0
    while np.any(changed2 != 0):
        counti = counti + 1
        f2, changed2 = continue_refreshing(f2, b1)
